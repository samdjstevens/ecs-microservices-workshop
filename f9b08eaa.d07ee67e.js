(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{84:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return s})),r.d(t,"metadata",(function(){return a})),r.d(t,"toc",(function(){return o})),r.d(t,"default",(function(){return l}));var n=r(3),c=(r(0),r(88));const s={id:"cluster",title:"Creating the ECS cluster",sidebar_label:"Creating the ECS cluster",slug:"/creating-the-ecs-cluster"},a={unversionedId:"cluster",id:"cluster",isDocsHomePage:!1,title:"Creating the ECS cluster",description:"The first thing we must do when using AWS ECS is to create a cluster. We will be using AWS Fargate to run our tasks, which means we don't need to worry about provisioning any EC2 instances for our cluster, as AWS will take care of this for us.",source:"@site/docs/cluster.md",slug:"/creating-the-ecs-cluster",permalink:"/ecs-microservices-workshop/creating-the-ecs-cluster",editUrl:"https://github.com/samdjstevens/ecs-microservices-workshop/edit/master/docs/cluster.md",version:"current",sidebar_label:"Creating the ECS cluster",sidebar:"someSidebar",previous:{title:"Elastic Container Service",permalink:"/ecs-microservices-workshop/elastic-container-service"},next:{title:"Creating an ECS Service",permalink:"/ecs-microservices-workshop/adding-a-service"}},o=[{value:"Creating the ECS Cluster with CDK",id:"creating-the-ecs-cluster-with-cdk",children:[]}],i={toc:o};function l({components:e,...t}){return Object(c.b)("wrapper",Object(n.a)({},i,t,{components:e,mdxType:"MDXLayout"}),Object(c.b)("p",null,"The first thing we must do when using AWS ECS is to create a ",Object(c.b)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AmazonECS/latest/developerguide/clusters.html"},"cluster"),". We will be using ",Object(c.b)("a",{parentName:"p",href:"https://aws.amazon.com/fargate/"},"AWS Fargate")," to run our tasks, which means we don't need to worry about provisioning any EC2 instances for our cluster, as AWS will take care of this for us."),Object(c.b)("h2",{id:"creating-the-ecs-cluster-with-cdk"},"Creating the ECS Cluster with CDK"),Object(c.b)("p",null,"To create the cluster, change/add the highlighted lines in the stack:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-javascript",metastring:'title="lib/translatr-cdk-stack.ts" {3,16-19}',title:'"lib/translatr-cdk-stack.ts"',"{3,16-19}":!0},"import { Stack, StackProps } from 'aws-cdk-lib';\nimport { Construct } from 'constructs';\nimport { aws_ec2 as ec2, aws_ecs as ecs } from 'aws-cdk-lib';\n\nexport class TranslatrCdkStack extends Stack {\n  constructor(scope: Construct, id: string, props?: StackProps) {\n    super(scope, id, props);\n\n    const vpc = new ec2.Vpc(this, 'ClusterVpc', {\n        cidr: '10.0.0.0/16',\n        maxAzs: 2\n    })\n\n    new ec2.BastionHostLinux(this, 'Bastion', { vpc })\n\n    const cluster = new ecs.Cluster(this, 'EcsCluster', {\n        vpc,\n        clusterName: 'translatr',\n    })\n\n  }\n}\n")),Object(c.b)("p",null,"Run ",Object(c.b)("inlineCode",{parentName:"p"},"cdk deploy")," again to deploy the changes to the stack and head back to the ",Object(c.b)("a",{parentName:"p",href:"https://eu-west-1.console.aws.amazon.com/ecs/home?region=eu-west-1#/clusters"},"AWS console"),", where you should now be able to see the cluster."),Object(c.b)("p",null,"We are now ready to deploy the first service that our app is comprised of, into the cluster."))}l.isMDXComponent=!0},88:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m}));var n=r(0),c=r.n(n);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,n,c=function(e,t){if(null==e)return{};var r,n,c={},s=Object.keys(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||(c[r]=e[r]);return c}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(c[r]=e[r])}return c}var l=c.a.createContext({}),u=function(e){var t=c.a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},p=function(e){var t=u(e.components);return c.a.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return c.a.createElement(c.a.Fragment,{},t)}},h=c.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,s=e.originalType,a=e.parentName,l=i(e,["components","mdxType","originalType","parentName"]),p=u(r),h=n,m=p["".concat(a,".").concat(h)]||p[h]||d[h]||s;return r?c.a.createElement(m,o(o({ref:t},l),{},{components:r})):c.a.createElement(m,o({ref:t},l))}));function m(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=r.length,a=new Array(s);a[0]=h;var o={};for(var i in t)hasOwnProperty.call(t,i)&&(o[i]=t[i]);o.originalType=e,o.mdxType="string"==typeof e?e:n,a[1]=o;for(var l=2;l<s;l++)a[l]=r[l];return c.a.createElement.apply(null,a)}return c.a.createElement.apply(null,r)}h.displayName="MDXCreateElement"}}]);